<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <h:form id="StoreListForm">
        <p:growl id="growl" showDetail="true" sticky="false"/>
        <p:panel header="Available Item List">            

            <p:tree value="#{categoryController.rootNode}" var="node" dynamic="true" cache="false"  
                    selectionMode="single"  selection="#{storeController.selectedNode}" id="tree" >  

                <p:ajax event="select" listener="#{storeController.onNodeSelect}" update=":StoreListForm:growl,:itemdataTable"/>
                <p:ajax event="unselect" listener="#{storeController.onNodeUnselect}" update=":StoreListForm:growl,:itemdataTable"/>  

                <p:treeNode>  
                    <h:outputText value="#{node}" />  
                </p:treeNode>  
            </p:tree>            
        </p:panel>
    </h:form>

    <h:panelGroup>        
        <h:form id="itemdataTable">
            <br/>
            <p:separator/>
            <br/>
            <p:panel header="Item List"   rendered="#{storeController.showItemList}">
                <p:dataTable value="#{storeController.storelist}" var="item" selectionMode="single"
                             selection="#{storeController.current}" rowKey="#{item.storePK}"
                             paginator="true" rows="10" rowsPerPageTemplate="10,20,30">
                    
                    <p:ajax event="rowSelect"   update=":itemdataTable:createstoreinButton, :itemdataTable:storeinButton, :itemdataTable:storeoutButton "/>
                    <p:ajax event="rowUnselect" update=":itemdataTable:createstoreinButton, :itemdataTable:storeinButton, :itemdataTable:storeoutButton"/>
                    
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="Item"/>
                        </f:facet>
                        <h:outputText value="#{item.item}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="StoreQuantity"/>
                        </f:facet>
                        <h:outputText value="#{item.storeQuantity}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="StoreUnit"/>
                        </f:facet>
                        <h:outputText value="#{item.storeUnit}"/>
                    </p:column>                    
                </p:dataTable>
                <f:facet name="footer">
                    <div class="footer-section">
                        <p:commandButton id="createstoreinButton" value="Create" action="../item/index.xhtml?faces-redirect=true"/>
                        <p:commandButton id="storeinButton" value="Store In" actionListener="#{storeinController.prepareCreate()}" oncomplete=""/>
                        <p:commandButton id="storeoutButton" value="Store Out" actionListener="#{storeinController.prepareCreate()}" oncomplete="" disabled="#{empty storeController.current}"/>
                    </div>
                </f:facet>
            </p:panel>            
        </h:form>
    </h:panelGroup>

</ui:composition>
